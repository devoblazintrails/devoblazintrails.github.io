<!-- start custom head snippets -->
<!-- START Formbricks Surveys -->
<script type="text/javascript">
!function(){
    var appUrl = "https://app.formbricks.com";
    var environmentId = "cmatvuvleam9nw201wq7k6put";
    var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=appUrl+"/js/formbricks.umd.cjs";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e),setTimeout(function(){window.formbricks.setup({environmentId: environmentId, appUrl: appUrl})},500)}();
</script>
<!-- END Formbricks Surveys -->

<link rel="icon" type="image/png" href="/assets/images/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="/assets/images/favicon.svg" />
<link rel="shortcut icon" href="/assets/images/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/assets/images/apple-touch-icon.png" />
<meta name="apple-mobile-web-app-title" content="MyWebSite" />
<link rel="manifest" href="/assets/images/site.webmanifest" />

<style>
#promoOverlay {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.6);
  z-index: 9999;
  justify-content: center;
  align-items: center;
  font-family: sans-serif;
}

#promoOverlay .popup-box {
  background: #fff;
  padding: 2rem;
  border-radius: 12px;
  max-width: 500px;
  width: 90%;
  box-shadow: 0 4px 20px rgba(0,0,0,0.3);
  position: relative;
  text-align: center;
}

#promoOverlay .popup-close {
  position: absolute;
  top: 10px;
  right: 16px;
  font-size: 1.5rem;
  cursor: pointer;
}

#promoOverlay h3 {
  color: #133f69;
  margin-top: 0;
}

#promoOverlay .medium-centered-button {
  background-color: #133f69;
  color: #c2b280;
  border: none;
  padding: 12px 24px;
  font-size: 1rem;
  border-radius: 8px;
  cursor: pointer;
  margin-top: 20px;
}
</style>

<script>
        // In-memory storage to track if overlay has been shown
        let overlayShown = false;
        
        document.addEventListener("DOMContentLoaded", function () {
            if (overlayShown) return;
            
            // Show overlay after delay
            setTimeout(() => {
                showOverlay();
            }, 5000); // 5 second delay
        });
        
        function showOverlay() {
            const overlay = document.getElementById('promoOverlay');
            overlay.style.display = 'flex';
            overlayShown = true;
        }
        
        function closeOverlay() {
            const overlay = document.getElementById('promoOverlay');
            overlay.style.display = 'none';
        }
        
        function resetOverlay() {
            overlayShown = false;
            closeOverlay();
            alert('Overlay memory reset! It will show again after 5 seconds.');
        }
        
        // Form validation and submission
        document.getElementById('promoForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const firstName = document.getElementById('userFirstName').value.trim();
            const lastName = document.getElementById('userLastName').value.trim();
            const email = document.getElementById('userEmail').value.trim();
            let isValid = true;
            
            // Reset previous errors
            document.getElementById('userFirstName').classList.remove('error');
            document.getElementById('userLastName').classList.remove('error');
            document.getElementById('userEmail').classList.remove('error');
            document.getElementById('firstNameError').style.display = 'none';
            document.getElementById('lastNameError').style.display = 'none';
            document.getElementById('emailError').style.display = 'none';
            
            // Validate first name
            if (!firstName || firstName.length < 1) {
                document.getElementById('userFirstName').classList.add('error');
                document.getElementById('firstNameError').style.display = 'block';
                isValid = false;
            }
            
            // Validate last name
            if (!lastName || lastName.length < 1) {
                document.getElementById('userLastName').classList.add('error');
                document.getElementById('lastNameError').style.display = 'block';
                isValid = false;
            }
            
            // Validate email
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!email || !emailRegex.test(email)) {
                document.getElementById('userEmail').classList.add('error');
                document.getElementById('emailError').textContent = !email ? 'Please enter your email address' : 'Please enter a valid email address';
                document.getElementById('emailError').style.display = 'block';
                isValid = false;
            }
            
            if (isValid) {
                // Show loading state
                const submitBtn = document.getElementById('submitBtn');
                const submitText = document.getElementById('submitText');
                const submitLoader = document.getElementById('submitLoader');
                
                submitBtn.disabled = true;
                submitText.style.display = 'none';
                submitLoader.style.display = 'inline';
                
                // Submit to Google Sheets
                submitToGoogleSheets(firstName, lastName, email)
                    .then(() => {
                        // Show success message
                        document.getElementById('formContent').style.display = 'none';
                        document.getElementById('successContent').style.display = 'block';
                    })
                    .catch((error) => {
                        console.error('Submission error:', error);
                        alert('There was an error submitting your information. Please try again.');
                        
                        // Reset button state
                        submitBtn.disabled = false;
                        submitText.style.display = 'inline';
                        submitLoader.style.display = 'none';
                    });
            }
        });
        
        // Function to submit data to Google Sheets
        async function submitToGoogleSheets(firstName, lastName, email) {
            // Google Apps Script web app URL
            const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycby_hWFbBvQiIHwyQDh1MGwkm-tvKiZoA5p7pg0JlDJJmXUK89fgkyQm2zNqTiH3mNj9/exec';
            
            const data = {
                firstName: firstName,
                lastName: lastName,
                email: email,
                offer: '500 credit for first project',
                timestamp: new Date().toISOString()
            };
            
            try {
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors', // Required for Google Apps Script
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
                // Note: With no-cors mode, we can't read the response
                // We'll assume success if no error is thrown
                console.log('Data submitted to Google Sheets:', data);
                return Promise.resolve();
                
            } catch (error) {
                console.error('Error submitting to Google Sheets:', error);
                throw error;
            }
        }
        
        // Close overlay when clicking outside the popup box
        document.getElementById('promoOverlay').addEventListener('click', function(e) {
            if (e.target === this) {
                closeOverlay();
            }
        });
        
        // Close overlay with Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeOverlay();
            }
        });
    </script>

<!-- end custom head snippets -->
